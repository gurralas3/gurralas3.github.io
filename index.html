<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Sai Teja Gurrala - Professional Page</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <style>
    body { background-color: #f4f6f9; }
    .clock-canvas { background-color: #e0e0e0; border-radius: 50%; }
    .section { padding: 30px 0; }
  </style>
</head>
<body>
<div class="container text-center">
  <div class="section">
    <h1><b>Sai Teja Gurrala</b></h1>
    <p>My headshot</p>
    <div id="email" onclick="showhideEmail()">Email: Show my email</div>
    <script src="email.js"></script>
    <a href="resume.pdf" class="btn btn-primary m-2">View Resume</a>
    <a href="waph.html" class="btn btn-info m-2">WAPH Course Overview</a>
    <p id="visit-msg"></p>
  </div>

  <div class="section">
    <h3>Digital Clock</h3>
    <p id="digit-clock"></p>
    <canvas id="analog-clock" width="150" height="150" class="clock-canvas"></canvas>
    <script src="https://waph-phung.github.io/clock.js"></script>
  </div>

  <div class="section">
    <h4>Random Programming Joke</h4>
    <div id="joke" class="font-italic text-muted"></div>
  </div>

  <div class="section">
    <h4>Today's XKCD Comic</h4>
    <img id="xkcd" src="" alt="XKCD Comic" class="img-fluid">
  </div>

  <div class="section">
    <h4>Visitor Tracker</h4>
    <img src="https://s11.flagcounter.com/count2/yourcode/bg_FFFFFF/txt_000000/border_CCCCCC/columns_3/maxflags_12/viewers_0/labels_1/pageviews_1/flags_1/" alt="Flag Counter">
  </div>
</div>

<script>
  // Show/Hide Email
  var shown = false;
  function showhideEmail() {
    if (shown) {
      document.getElementById('email').innerHTML = "Email: Show my email";
      shown = false;
    } else {
      var myemail = "<a href='mailto:gurralas3@udayton.edu'>gurralas3@udayton.edu</a>";
      document.getElementById('email').innerHTML = "Email: " + myemail;
      shown = true;
    }
  }

  // Digital Clock
  function displayTime() {
    document.getElementById('digit-clock').innerHTML = new Date();
  }
  setInterval(displayTime, 1000);

  // Analog Clock
  var canvas = document.getElementById("analog-clock");
  var ctx = canvas.getContext("2d");
  var radius = canvas.height / 2;
  ctx.translate(radius, radius);
  radius *= 0.90;
  setInterval(() => {
    drawFace(ctx, radius);
    drawNumbers(ctx, radius);
    drawTime(ctx, radius);
  }, 1000);

  // Joke API (refresh every 1 min)
  function fetchJoke() {
    $.get("https://v2.jokeapi.dev/joke/Programming?type=single", function(data) {
      if (data && data.joke) {
        $("#joke").text(data.joke);
      }
    });
  }
  fetchJoke();
  setInterval(fetchJoke, 60000);

  // XKCD API
  fetch("https://xkcd.com/info.0.json")
    .then(res => res.json())
    .then(data => {
      document.getElementById("xkcd").src = data.img;
    });

  // Cookie Visitor
  const msg = document.getElementById("visit-msg");
  let lastVisit = document.cookie.replace(/(?:(?:^|.*;\s*)lastVisit\s*\=\s*([^;]*).*$)|^.*$/, "$1");
  let now = new Date().toLocaleString();
  if (!lastVisit) {
    msg.textContent = "Welcome to my homepage!";
  } else {
    msg.textContent = `Welcome back! Your last visit was ${lastVisit}`;
  }
  document.cookie = "lastVisit=" + now + "; path=/";
</script>
</body>
</html>
